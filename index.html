<!DOCTYPE html>
<html lang="en">

<head>
    <title>Altes Polizeipräsidium Frankfurt</title>
    <meta property="og:description" content="Style a polygon with the fill layer type." />
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel='stylesheet' href='https://unpkg.com/maplibre-gl@4.1.3/dist/maplibre-gl.css' />
    <script src='https://unpkg.com/maplibre-gl@4.1.3/dist/maplibre-gl.js'></script>
    <style>
    body {
        margin: 0;
        padding: 0;
    }

    html,
    body,
    #map {
        height: 100%;
    }

    .maplibregl-popup {
        max-width: none !important;
        /* Maximalbreite des Popups überschreiben */
    }

    .maplibregl-popup-content {
        max-width: none !important;
        /* Maximalbreite des Popups überschreiben */
    }

    .custom-popup {
        max-width: 400px;
        /* Maximale Breite des benutzerdefinierten Popups */
        max-height: 400px;
        /* Maximale Höhe des benutzerdefinierten Popups */
        overflow: auto;
        /* Scrollen erlauben, wenn der Inhalt größer ist */
    }

    .custom-popup img {
        display: block;
        /* Bild als Blockelement anzeigen */
        max-width: 100%;
        /* Maximale Breite des Bildes */
        height: auto;
        /* Höhe automatisch anpassen */
    }
	
		.legend {
		position: absolute;
		bottom: 30px;
		left: 10px;
		padding: 10px;
		background-color: white;
		border-radius: 5px;
		box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
		font-family: Arial, sans-serif;
		font-size: 14px;
		line-height: 18px;
		color: #333;
	}

	.legend div {
		display: flex;
		align-items: center;
		margin-bottom: 5px;
	}

	.legend div span {
		width: 20px;
		height: 20px;
		display: inline-block;
		margin-right: 5px;
		border: 1px solid #ccc;
	}
	
	
    </style>
</head>

<body>


    <div id="map"></div>
    <div class="legend">
        <div><span style="background-color: #5C0202;"></span>Ground Floor</div>
        <div><span style="background-color: #BF3604;"></span>First Floor</div>
        <div><span style="background-color: #D9734E;"></span>Second Floor</div>
        <div><span style="background-color: #223F47;"></span>Surrounding Streets</div>
        <div><span style="background-color: #74888C;"></span>From the Internet</div>
    </div>

    <script>
    // Map-Objekt erstellen
    let map;

    const osm_style = {
        "version": 8,
        "glyphs": "https://kulturdb.de/maplibre_font/{fontstack}/{range}.pbf",
        "sources": {
            "osm": {
                "type": "raster",
                "tiles": ["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png"],
                "tileSize": 256,
                "attribution": "&copy; OpenStreetMap Contributors",
                "maxzoom": 19
            }
        },
        "layers": [{
            "id": "osm",
            "type": "raster",
            "source": "osm"
        }]
    };


    // Map-Objekt erstellen
    map = new maplibregl.Map({
        container: 'map',
        //style: osm_style,
        style: 'https://sgx.geodatenzentrum.de/gdz_basemapde_vektor/styles/bm_web_gry.json',
        //style: 'https://api.maptiler.com/maps/streets/style.json?key=Oe8WoupkUBf5lpBnHuxA',
        //style: 'https://api.maptiler.com/maps/topo-v2/style.json?key=Oe8WoupkUBf5lpBnHuxA',
        center: [8.658277602810918, 50.10954834382793],
        zoom: 17,
    });

    map.on('load', async () => {
        // Add images to use as a custom marker
        // Bildpfad
        const imagepath = [];
        // Schleife durch den Bildpfad
        for (let img of imagepath) {
            // Bild laden
            const image = await map.loadImage(img);
            // Bild der Karte hinzufügen
            map.addImage(img, image.data);
        }


        map.addSource('src_eg', {
            type: 'geojson',
            data: 'data/pics_eg.geojson'
        });
			

        map.addSource('src_og1', {
            type: 'geojson',
            data: 'data/pics_og1.geojson'
        });
		

        map.addSource('src_og2', {
            type: 'geojson',
            data: 'data/pics_og2.geojson'
        });
		

        map.addSource('src_street', {
            type: 'geojson',
            data: 'data/pics_street.geojson'
        });
		
		 map.addSource('src_internet', {
            type: 'geojson',
            data: 'data/pics_internet.geojson'
        });

		//EG
        map.addLayer({
            id: 'fotos_eg',
            type: 'circle', 
            source: 'src_eg',
            paint: {
                'circle-radius': [
                    'interpolate',
                    ['linear'],
                    ['zoom'],
                    // Zoomstufe, Radius wachsen je nach zoomstufe
                    12, 2, 
                    14, 4, 
                    19.1, 6, 
                    21, 10 
                ],
                'circle-color': '#5C0202',
				'circle-stroke-width': 2,  // Breite der Außenlinie
				'circle-stroke-color': '#ccc' // Farbe der Außenlinie
            }
        });


        //Abfrage EG
        map.on('click', 'fotos_eg', (e) => {
            new maplibregl.Popup()
                .setLngLat(e.lngLat)
                .setHTML('<div class="custom-popup"><strong>Ground Floor</strong> ' + e.features[0].properties.Date + '<br><img src="pics/eg/' + e.features[0].properties.Name + '" ></div>')
                .addTo(map);
        });

        // Change the cursor to a pointer when the mouse is over the states layer.
        map.on('mouseenter', 'fotos_eg', () => {
            map.getCanvas().style.cursor = 'pointer';
        });

        // Change it back to a pointer when it leaves.
        map.on('mouseleave', 'fotos_eg', () => {
            map.getCanvas().style.cursor = '';
        });
		
		
		
		//OG1
        map.addLayer({
            id: 'fotos_og1',
            type: 'circle', 
            source: 'src_og1',
            paint: {
                'circle-radius': [
                    'interpolate',
                    ['linear'],
                    ['zoom'],
                    // Zoomstufe, Radius wachsen je nach zoomstufe
                    12, 2, 
                    14, 4, 
                    19.1, 6, 
                    21, 10 
                ],
                'circle-color': '#BF3604',
				'circle-stroke-width': 2,  // Breite der Außenlinie
				'circle-stroke-color': '#ccc' // Farbe der Außenlinie
            }
        });


        //Abfrage OG1
        map.on('click', 'fotos_og1', (e) => {
            new maplibregl.Popup()
                .setLngLat(e.lngLat)
                .setHTML('<div class="custom-popup"><strong>First Floor</strong> ' + e.features[0].properties.Date + '<br><img src="pics/og1/' + e.features[0].properties.Name + '" ></div>')
                .addTo(map);
        });

        // Change the cursor to a pointer when the mouse is over the states layer.
        map.on('mouseenter', 'fotos_og1', () => {
            map.getCanvas().style.cursor = 'pointer';
        });

        // Change it back to a pointer when it leaves.
        map.on('mouseleave', 'fotos_og1', () => {
            map.getCanvas().style.cursor = '';
        });


		//OG2
        map.addLayer({
            id: 'fotos_og2',
            type: 'circle', 
            source: 'src_og2',
            paint: {
                'circle-radius': [
                    'interpolate',
                    ['linear'],
                    ['zoom'],
                    // Zoomstufe, Radius wachsen je nach zoomstufe
                    12, 2, 
                    14, 4, 
                    19.1, 6, 
                    21, 10 
                ],
                'circle-color': '#D9734E',
				'circle-stroke-width': 2,  // Breite der Außenlinie
				'circle-stroke-color': '#ccc' // Farbe der Außenlinie
            }
        });


        //Abfrage OG2
        map.on('click', 'fotos_og2', (e) => {
            new maplibregl.Popup()
                .setLngLat(e.lngLat)
                .setHTML('<div class="custom-popup"><strong>Second Floor</strong> ' + e.features[0].properties.Date + '<br><img src="pics/og2/' + e.features[0].properties.Name + '" ></div>')
                .addTo(map);
        });

        // Change the cursor to a pointer when the mouse is over the states layer.
        map.on('mouseenter', 'fotos_og2', () => {
            map.getCanvas().style.cursor = 'pointer';
        });

        // Change it back to a pointer when it leaves.
        map.on('mouseleave', 'fotos_og2', () => {
            map.getCanvas().style.cursor = '';
        });
		
		
		//Street
        map.addLayer({
            id: 'fotos_street',
            type: 'circle', 
            source: 'src_street',
            paint: {
                'circle-radius': [
                    'interpolate',
                    ['linear'],
                    ['zoom'],
                    // Zoomstufe, Radius wachsen je nach zoomstufe
                    12, 2, 
                    14, 4, 
                    19.1, 6, 
                    21, 10 
                ],
                'circle-color': '#223F47',
				'circle-stroke-width': 2,  // Breite der Außenlinie
				'circle-stroke-color': '#ccc' // Farbe der Außenlinie
            }
        });


        //Abfrage Street
        map.on('click', 'fotos_street', (e) => {
            new maplibregl.Popup()
                .setLngLat(e.lngLat)
                .setHTML('<div class="custom-popup"><strong>Surrounding streets</strong> ' + e.features[0].properties.Date + '<br><img src="pics/street/' + e.features[0].properties.Name + '" ></div>')
                .addTo(map);
        });

        // Change the cursor to a pointer when the mouse is over the states layer.
        map.on('mouseenter', 'fotos_street', () => {
            map.getCanvas().style.cursor = 'pointer';
        });

        // Change it back to a pointer when it leaves.
        map.on('mouseleave', 'fotos_street', () => {
            map.getCanvas().style.cursor = '';
        });		

		//Internet
        map.addLayer({
            id: 'fotos_internet',
            type: 'circle', 
            source: 'src_internet',
            paint: {
                'circle-radius': [
                    'interpolate',
                    ['linear'],
                    ['zoom'],
                    // Zoomstufe, Radius wachsen je nach zoomstufe
                    12, 2, 
                    14, 4, 
                    19.1, 6, 
                    21, 10 
                ],
                'circle-color': '#74888C',
				'circle-stroke-width': 2,  // Breite der Außenlinie
				'circle-stroke-color': '#ccc' // Farbe der Außenlinie
            }
        });


        //Abfrage internet
        map.on('click', 'fotos_internet', (e) => {
            new maplibregl.Popup()
                .setLngLat(e.lngLat)
                .setHTML('<div class="custom-popup"><strong>From the Internet</strong> ' + e.features[0].properties.Date + '<br><img src="pics/internet/' + e.features[0].properties.Name + '" ></div>')
                .addTo(map);
        });

        // Change the cursor to a pointer when the mouse is over the states layer.
        map.on('mouseenter', 'fotos_internet', () => {
            map.getCanvas().style.cursor = 'pointer';
        });

        // Change it back to a pointer when it leaves.
        map.on('mouseleave', 'fotos_internet', () => {
            map.getCanvas().style.cursor = '';
        });	



        // Navigationssteuerelemente hinzufügen
        map.addControl(new maplibregl.NavigationControl());

        // Geolocate-Steuerung hinzufügen
        map.addControl(
            new maplibregl.GeolocateControl({
                positionOptions: {
                    enableHighAccuracy: true
                },
                trackUserLocation: true
            })
        );


    });


    // Füge die Maßstabsanzeige hinzu
    var scale = new maplibregl.ScaleControl({
        maxWidth: 80, // Maximale Breite der Maßstabsanzeige in Pixeln
        unit: 'metric' // Einheit der Maßstabsanzeige ('imperial' für Meilen)
    });
    map.addControl(scale, 'bottom-right'); // Positioniere die Maßstabsanzeige unten rechts
    </script>
</body>

</html>